# 웹 광고 클릭률 예측

## 문제 인식

### 1. 메모리 문제

**문제**: `train` 데이터의 양이 너무 많아서 메모리 오류 발생  
**해결**: `nrows` 파라미터를 사용하여 데이터를 점진적으로 불러오기  
- 1000개부터 20,000,000개까지 데이터를 불러옴
- **결과**: 데이터 수를 증가시키면서 미세하지만 정확도가 올랐음. 하지만 숫자에 한계가 있었고, 컴퓨터 성능에 따라 처리 속도가 매우 달랐음.

### 2. 일관되지 않은 스케일

**문제**: 데이터 스케일이 서로 다름  
**해결**: `print(df.describe())`를 사용하여 데이터 확인 후 표준화 필요  
- 이미 훈련된 스케일러를 사용하여 표준화 수행
- **모델 변경**: AdaBoost에서 최종적으로 LightGBM을 사용
  - **결과**: 정확도 0.73에서 0.75로 증가

### 3. 하이퍼파라미터 최적화 상태 미비

**문제**: 하이퍼파라미터 설정이 되어 있지 않음  
**해결**: 최적의 하이퍼파라미터 찾기 위해 Optuna 사용  
- 초기에는 Grid Search 사용했으나 시간이 너무 오래 걸림
- LightGBM으로 모델을 변경하면서 Grid Search를 Optuna로 변경
- Optuna 사용 시 K-fold 교차 검증도 함께 사용
  - **K-fold 교차 검증**: 데이터셋을 K개의 폴드로 나누고, 각 폴드가 한 번씩 테스트 셋으로 사용되며 나머지 폴드들이 학습 셋으로 사용되는 방식으로 모델의 일반화 성능을 평가
  - **결과**: 정확도 0.76까지 증가

**Grid Search 문제점**: 최적의 파라미터를 찾기 위해 하나씩 숫자를 바꿔가며 어블레이션 스터디를 진행하려 했으나 시간이 너무 오래 걸려 포기  
**Optuna 문제점**: `n_trials` 숫자를 100에서 더 늘려보려 했으나 대회 종료까지 시간이 부족하여 실행하지 못함. 시간이 더 있었다면 `n_trials` 숫자를 점점 늘려가면서 정확도를 더 높일 수 있었을 것으로 생각됨.

## 결론

메모리 문제를 해결하고, 데이터 스케일을 표준화하였으며, 하이퍼파라미터 최적화를 통해 정확도를 0.73에서 0.76까지 증가시킴.  
Optuna를 사용하여 K-fold 교차 검증과 함께 최적의 하이퍼파라미터를 찾았으며, 추가적인 시간과 자원이 있었다면 정확도를 더욱 높일 수 있었을 것임.
